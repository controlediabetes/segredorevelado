// Função para calcular o tempo restante
function getTimeRemaining(endtime) {
    const total = Date.parse(endtime) - Date.parse(new Date());
    const segundos = Math.floor((total / 1000) % 60);
    const minutos = Math.floor((total / 1000 / 60) % 60);
    const horas = Math.floor((total / (1000 * 60 * 60)) % 24);
    const dias = Math.floor(total / (1000 * 60 * 60 * 24));

    return {
        total,
        dias,
        horas,
        minutos,
        segundos
    };
}

function initializeClock(id, endtime) {
    const clock = document.querySelector('.countdown');
    const diasSpan = clock.querySelector('#dias');
    const horasSpan = clock.querySelector('#horas');
    const minutosSpan = clock.querySelector('#minutos');
    const segundosSpan = clock.querySelector('#segundos');

    function updateClock() {
        const t = getTimeRemaining(endtime);

        diasSpan.innerHTML = t.dias;
        horasSpan.innerHTML = ('0' + t.horas).slice(-2);
        minutosSpan.innerHTML = ('0' + t.minutos).slice(-2);
        segundosSpan.innerHTML = ('0' + t.segundos).slice(-2);

        if (t.total <= 0) {
            clearInterval(timeInterval);
        }
    }

    updateClock();
    const timeInterval = setInterval(updateClock, 1000);
}

// Define a data de término do contador (7 dias a partir de agora)
const deadline = new Date(Date.parse(new Date()) + 7 * 24 * 60 * 60 * 1000);
initializeClock('countdown', deadline);


// Chat Fake
const chatMessages = document.querySelector('.chat-messages');
const messageInput = document.querySelector('#message-input');
const sendButton = document.querySelector('#send-button');

// Lista de mensagens fakes
const fakeMessages = [
    {
        name: "Maria Silva",
        message: "Estou muito feliz com os resultados que obtive com este produto!",
        image: "https://thispersondoesnotexist.com/image"
    },
    {
        name: "João Pedro",
        message: "Realmente funciona! Minha glicose está controlada como nunca antes.",
        image: "https://thispersondoesnotexist.com/image"
    },
    {
        name: "Ana Clara",
        message: "Recomendo a todos que sofrem com diabetes. Este produto mudou minha vida!",
        image: "https://thispersondoesnotexist.com/image"
    }
];

// Função para adicionar uma mensagem ao chat
function addMessage(name, message, image) {
    const messageElement = document.createElement('div');
    messageElement.classList.add('message');

    messageElement.innerHTML = `
        <img src="${image}" alt="${name}">
        <div class="message-content">
            <strong>${name}</strong>
            <p>${message}</p>
        </div>
    `;

    chatMessages.appendChild(messageElement);

    // Rola para a última mensagem
    chatMessages.scrollTop = chatMessages.scrollHeight;
}

// Adiciona mensagens fakes iniciais
fakeMessages.forEach(message => {
    addMessage(message.name, message.message, message.image);
});

// Adiciona uma mensagem do usuário
function addUserMessage(message) {
    const userMessage = document.createElement('div');
    userMessage.classList.add('message');

    userMessage.innerHTML = `
        <img src="https://thispersondoesnotexist.com/image" alt="Você">
        <div class="message-content">
            <strong>Você</strong>
            <p>${message}</p>
        </div>
    `;

    chatMessages.appendChild(userMessage);

    // Rola para a última mensagem
    chatMessages.scrollTop = chatMessages.scrollHeight;
}

// Envia a mensagem do usuário ao clicar no botão
sendButton.addEventListener('click', () => {
    const message = messageInput.value;
    if (message) {
        addUserMessage(message);
        messageInput.value = '';

        // Simula uma resposta fake após alguns segundos
        setTimeout(() => {
            const randomIndex = Math.floor(Math.random() * fakeMessages.length);
            const randomMessage = fakeMessages[randomIndex];
            addMessage(randomMessage.name, randomMessage.message, randomMessage.image);
        }, 2000);
    }
});

// Envia a mensagem do usuário ao pressionar Enter
messageInput.addEventListener('keyup', event => {
    if (event.key === 'Enter') {
        sendButton.click();
    }
});
